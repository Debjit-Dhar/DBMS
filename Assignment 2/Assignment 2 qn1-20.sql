-- your code goes here
--Display each table
CREATE TABLE EMP(
  	EMP_CODE  	char(5) PRIMARY KEY,
   	EMP_NAME	char(20),
	DEPT_CODE	char(5),
	DESIG_CODE	char(5),
	SEX 		char(1),
    ADDRESS 	char (25),
    CITY 		char (20),
    STATE       char (20),
    PIN    		char (6),
    BASIC 		Number,
    JN_DT		Date);	
CREATE TABLE DESIGNATION(
	DESIG_CODE 	char(5) PRIMARY KEY,
	DESIG_DESC	char(20));
	
CREATE TABLE DEPARTMENT(
	DEPT_CODE 	char(5) PRIMARY KEY,
	DEPT_NAME	char(15));

-- Insert values into DESIGNATION table
INSERT INTO DESIGNATION (DESIG_CODE, DESIG_DESC) VALUES 
('MGR', 'Manager'),
('EXE', 'Executive'),
('OFR', 'Officer'),
('CLK', 'Clerk'),
('HLP', 'Helper'),
('CEO', 'Ceo');

-- Insert values into DEPARTMENT table
INSERT INTO DEPARTMENT (DEPT_CODE, DEPT_NAME) VALUES 
('PRL', 'Personnel'),
('PRO', 'Production'),
('PUR', 'Purchase'),
('FIN', 'Finance'),
('RES', 'Research'),
('DEB', 'Debugger');

-- Insert values into EMP table
INSERT INTO EMP (EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E001', 'John Doe', 'PRL', 'MGR', 'M', '123 Main St', 'New York', 'NY', '10001', 80000, TO_DATE('2022-05-10', 'YYYY-MM-DD')),
('E002', 'Jane Smith', 'PRO', 'EXE', 'F', '456 Park Ave', 'Los Angeles', 'CA', '90001', 60000, TO_DATE('2021-07-15', 'YYYY-MM-DD')),
('E003', 'Michael Brown', 'PUR', 'OFR', 'M', '789 Elm St', 'Chicago', 'IL', '60601', 50000, TO_DATE('2020-08-20', 'YYYY-MM-DD')),
('E004', 'Emily Davis', 'FIN', 'CLK', 'F', '101 Pine St', 'Houston', 'TX', '77001', 0, TO_DATE('2019-09-25', 'YYYY-MM-DD')),
('E005', 'Robert Wilson', 'RES', 'HLP', 'M', '202 Cedar Rd', 'San Francisco', 'CA', '94101', 30000, TO_DATE('2018-10-30', 'YYYY-MM-DD'));
-- Insert values into EMP table without DEPT_CODE and BASIC,QUESTION 4
INSERT INTO EMP (EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, JN_DT) VALUES 
('E006', 'Alice Johnson', 'EXE', 'F', '303 Maple St', 'Boston', 'MA', '02101', TO_DATE('2023-01-12', 'YYYY-MM-DD')),
('E007', 'David Lee', 'CLK', 'M', '404 Oak St', 'Seattle', 'WA', '98101', TO_DATE('2022-06-15', 'YYYY-MM-DD')),
('E008', 'Sophia Martinez', 'MGR', 'F', '505 Birch Rd', 'Denver', 'CO', '80201', TO_DATE('2021-11-20', 'YYYY-MM-DD'));

--QUESTION 1
SELECT DEPT_CODE,MIN(BASIC),MAX(BASIC),AVG(BASIC) FROM EMP GROUP BY DEPT_CODE;

--QUESTION 2  
SELECT DEPT_CODE,COUNT(*) FROM EMP WHERE SEX='F' AND DEPT_CODE IS NOT NULL GROUP BY DEPT_CODE;

--QUESTION 3  
SELECT CITY,COUNT(*) FROM EMP WHERE CITY IS NOT NULL GROUP BY CITY;

--QUESTION 4  
SELECT DEPT_CODE,DESIG_CODE,COUNT(*) FROM EMP WHERE EXTRACT(YEAR FROM JN_DT)>2000 GROUP BY DEPT_CODE,DESIG_CODE ORDER BY COUNT(*);

--QUESTION 5  
SELECT DEPT_CODE,SUM(BASIC) FROM EMP WHERE SEX='M' GROUP BY DEPT_CODE HAVING SUM(BASIC)>50000 ORDER BY SUM(BASIC) DESC;

--QUESTION 6  
SELECT EMP_NAME,DESIG_DESC,BASIC FROM EMP E,DESIGNATION D WHERE E.DESIG_CODE=D.DESIG_CODE;

--QUESTION 7 
CREATE VIEW EMP_DESIG AS (SELECT EMP_NAME,DESIG_DESC,DEPT_CODE,BASIC FROM EMP E,DESIGNATION D WHERE E.DESIG_CODE=D.DESIG_CODE);
SELECT E.EMP_NAME,E.DESIG_DESC,D.DEPT_NAME,E.BASIC FROM EMP_DESIG E,DEPARTMENT D WHERE  E.DEPT_CODE=D.DEPT_CODE;

--QUESTION 8 
SELECT D.DEPT_CODE FROM DEPARTMENT D
WHERE NOT EXISTS (SELECT 1 FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE);

--QUESTION 9 
SELECT D.DEPT_CODE,D.DEPT_NAME FROM DEPARTMENT D WHERE EXISTS(SELECT E.DEPT_CODE FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE); 

--QUESTION 10 
SELECT D.DEPT_CODE,D.DEPT_NAME FROM DEPARTMENT D WHERE (SELECT COUNT(*) FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE)>10; 

--QUESTION 11 
SELECT DEPT_CODE FROM EMP WHERE BASIC=(SELECT MAX(BASIC) FROM EMP);

--QUESTION 12  
SELECT DESIG_CODE,DESIG_DESC FROM DESIGNATION WHERE DESIG_CODE=(SELECT DISTINCT DESIG_CODE FROM EMP WHERE BASIC=(SELECT MAX(BASIC) FROM EMP));

--QUESTION 13  
SELECT E.DEPT_CODE, COUNT(*) FROM EMP E JOIN DESIGNATION D ON E.DESIG_CODE = D.DESIG_CODE WHERE DEPT_CODE IS NOT NULL AND DESIG_DESC = 'Manager' GROUP BY DEPT_CODE;

--QUESTION 14  
SELECT BASIC FROM EMP WHERE BASIC>=ALL(SELECT DISTINCT BASIC FROM EMP WHERE BASIC IS NOT NULL);

--QUESTION 15  
SELECT BASIC FROM EMP WHERE BASIC<=ALL(SELECT DISTINCT BASIC FROM EMP WHERE BASIC IS NOT NULL);

--QUESTION 16 
CREATE VIEW AVG_BASIC AS SELECT DEPT_CODE,AVG(BASIC) B FROM EMP GROUP BY DEPT_CODE;
SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE IN (SELECT DEPT_CODE FROM AVG_BASIC WHERE  B = (SELECT MAX(B) FROM AVG_BASIC));

--QUESTION 17  
INSERT INTO EMP (EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) 
VALUES('E009', 'Chris Evans', 'FIN', 'XYZ', 'M', '606 Walnut St', 'Miami', 'FL', '33101', 70000, TO_DATE('2022-02-15', 'YYYY-MM-DD')),('E010', 'Natalie Portman', 'PRL', 'ABC', 'F', '707 Palm St', 'Austin', 'TX', '73301', 55000, TO_DATE('2023-03-10', 'YYYY-MM-DD'));

--QUESTION 18  
DELETE FROM EMP E WHERE E.DESIG_CODE NOT IN (SELECT DESIG_CODE FROM DESIGNATION);

--QUESTION 19  
SELECT EMP_NAME,DEPT_CODE FROM EMP  E WHERE SEX='F' AND BASIC>(SELECT B FROM AVG_BASIC A WHERE A.DEPT_CODE=E.DEPT_CODE);

--QUESTION 20  
SELECT COUNT(*) FROM EMP WHERE SEX='F' AND DESIG_CODE=(SELECT DESIG_CODE FROM DESIGNATION WHERE DESIG_DESC='Manager');