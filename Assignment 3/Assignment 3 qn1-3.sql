-- your code goes here
CREATE TABLE ORGANIZATION(
ORG_ID CHAR(5) PRIMARY KEY);

CREATE TABLE DEPARTMENT(
DCODE CHAR(5) PRIMARY KEY,
DNAME CHAR(25),
ORG_ID CHAR(5) NOT NULL,
FOREIGN KEY(ORG_ID) REFERENCES ORGANIZATION(ORG_ID));

CREATE TABLE EMPLOYEE(
ECODE CHAR(5) PRIMARY KEY,
ENAME CHAR(25) CHECK(ENAME=UPPER(ENAME)),
ADDRESS CHAR(25),
CITY CHAR(10),
BASIC INT CHECK(BASIC>=50000 AND BASIC<=90000),
JN_DT DATE DEFAULT SYSDATE,
DCODE CHAR(5) NOT NULL,
FOREIGN KEY(DCODE) REFERENCES DEPARTMENT(DCODE));

CREATE TABLE LEAVE_REGISTER(
LEAVE_TYPE CHAR(5) NOT NULL CHECK(LEAVE_TYPE='CL' OR LEAVE_TYPE='EL' OR LEAVE_TYPE='ML'),
FROM_DT DATE,
TO_DT DATE,
ECODE CHAR(5) NOT NULL, 
FOREIGN KEY(ECODE) REFERENCES EMPLOYEE(ECODE),
PRIMARY KEY(ECODE,LEAVE_TYPE,FROM_DT));

DESC ORGANIZATION;
DESC EMPLOYEE;
DESC LEAVE_REGISTER;

INSERT INTO ORGANIZATION (ORG_ID) VALUES ('ORG01');
INSERT INTO DEPARTMENT (DCODE, DNAME, ORG_ID) VALUES ('D001', 'HR', 'ORG01');
INSERT INTO DEPARTMENT (DCODE, DNAME, ORG_ID) VALUES ('D002', 'Finance', 'ORG01');
INSERT INTO DEPARTMENT (DCODE, DNAME, ORG_ID) VALUES ('D003', 'IT', 'ORG01'); 
-- Multiple employees in HR (D001)
INSERT INTO EMPLOYEE (ECODE, ENAME, ADDRESS, CITY, BASIC, DCODE) 
VALUES ('E001', 'JOHN DOE', '123 Street', 'New York', 70000, 'D001');

INSERT INTO EMPLOYEE (ECODE, ENAME, ADDRESS, CITY, BASIC, DCODE) 
VALUES ('E002', 'JANE SMITH', '456 Avenue', 'LA', 80000, 'D001');

-- One employee in Finance (D002)
INSERT INTO EMPLOYEE (ECODE, ENAME, ADDRESS, CITY, BASIC, DCODE) 
VALUES ('E003', 'ROBERT BROWN', '789 Blvd', 'Chicago', 90000, 'D002');

-- No employees in IT (D003)
-- E001 takes Casual Leave (CL)
INSERT INTO LEAVE_REGISTER(LEAVE_TYPE, FROM_DT, TO_DT, ECODE) VALUES('CL', TO_DATE('01-OCT-2024'), TO_DATE('01-DEC-2024'), 'E001');

-- E002 takes Earned Leave (EL)
INSERT INTO LEAVE_REGISTER(LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES('EL', TO_DATE('02-MAY-2024'), '02-AUG-2024', 'E002');

-- E003 takes Medical Leave (ML)
INSERT INTO LEAVE_REGISTER(LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES('ML', '03-JAN-2024', '03-OCT-2024', 'E003');
-- E001 takes Earned Leave (EL) from 01-Feb-2024 to 10-Feb-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('EL', TO_DATE('01-FEB-2024', 'DD-MON-YYYY'), TO_DATE('10-FEB-2024', 'DD-MON-YYYY'), 'E001');

-- E001 takes Medical Leave (ML) from 15-Mar-2024 to 20-Mar-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('ML', TO_DATE('15-MAR-2024', 'DD-MON-YYYY'), TO_DATE('20-MAR-2024', 'DD-MON-YYYY'), 'E001');

-- E002 takes Casual Leave (CL) from 05-Apr-2024 to 07-Apr-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('CL', TO_DATE('05-APR-2024', 'DD-MON-YYYY'), TO_DATE('07-APR-2024', 'DD-MON-YYYY'), 'E002');

-- E002 takes Earned Leave (EL) from 10-Aug-2024 to 12-Aug-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('EL', TO_DATE('10-AUG-2024', 'DD-MON-YYYY'), TO_DATE('12-AUG-2024', 'DD-MON-YYYY'), 'E002');

-- E003 takes Casual Leave (CL) from 15-Nov-2024 to 20-Nov-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('CL', TO_DATE('15-NOV-2024', 'DD-MON-YYYY'), TO_DATE('20-NOV-2024', 'DD-MON-YYYY'), 'E003');

-- E003 takes Earned Leave (EL) from 10-Feb-2024 to 15-Feb-2024
INSERT INTO LEAVE_REGISTER (LEAVE_TYPE, FROM_DT, TO_DT, ECODE) 
VALUES ('EL', TO_DATE('10-FEB-2024', 'DD-MON-YYYY'), TO_DATE('15-FEB-2024', 'DD-MON-YYYY'), 'E003');
SELECT * FROM ORGANIZATION;
SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;
SELECT * FROM LEAVE_REGISTER;

CREATE TABLE TEMP AS  
SELECT ECODE,ENAME,DNAME,BASIC FROM EMPLOYEE NATURAL JOIN DEPARTMENT WHERE DCODE='D001' AND BASIC>70000;

SELECT * FROM TEMP;

INSERT INTO TEMP (ECODE, ENAME, DNAME, BASIC)
SELECT ECODE, ENAME, DNAME, BASIC
FROM EMPLOYEE NATURAL JOIN DEPARTMENT
WHERE BASIC > 70000 AND DCODE<>'D001';


ALTER TABLE TEMP
ADD(NETPAY FLOAT);

UPDATE TEMP SET NETPAY=1.5*BASIC;

SELECT * FROM TEMP;

ALTER TABLE TEMP DROP COLUMN NETPAY;

SELECT * FROM TEMP;